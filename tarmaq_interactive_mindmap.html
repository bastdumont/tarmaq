<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte Mentale Tarmaq - Navigation Gauche √† Droite</title>
    <style>
        :root {
          --bg: #F7F8FB;
          --ink: #1F2937;
          --muted: #6B7280;
          --primary: #6B46C1;
          --primary-200: #C4B5FD;
          --primary-100: #EDE9FE;
          --secondary: #2563EB;
          --secondary-100: #DBEAFE;
          --accent: #10B981;
          --accent-100: #D1FAE5;
          --surface: #FFFFFF;
          --shadow-sm: 0 2px 8px rgba(0,0,0,.08);
          --shadow-md: 0 8px 24px rgba(0,0,0,.12);
        }

        html, body { background: var(--bg); color: var(--ink); }

        .hidden { display: none !important; }

        .selected { outline: 3px solid var(--secondary); outline-offset: 2px; }

        /* Navigation styles */
        .btn-secondary {
          background: rgba(255, 255, 255, 0.9);
          color: #2a2a2a;
          padding: 14px 24px;
          border-radius: 16px;
          font-weight: 700;
          transition: all 0.3s ease;
          border: 1px solid #e8e8ec;
          cursor: pointer;
        }

        .btn-secondary:hover {
          background: white;
          transform: translateY(-2px);
          box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .btn-gradient {
          background: linear-gradient(140deg, #ff9d9b, #da2f2c);
          color: white;
          padding: 14px 24px;
          border-radius: 16px;
          font-weight: 700;
          transition: all 0.3s ease;
          border: none;
          cursor: pointer;
        }

        .btn-gradient:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 20px rgba(218, 47, 44, 0.25);
        }

        /* Header text colors */
        .text-ink-2 { color: #2a2a2a; }
        .text-brand { color: #da2f2c; }
        .border-stroke { border-color: #e8e8ec; }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            background: var(--bg);
            min-height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        .mindmap-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            cursor: grab;
            overflow: hidden;
        }

        .mindmap {
            width: 4000px;
            height: 3000px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-25%, -50%);
            transition: transform 0.3s ease;
            will-change: transform;
        }

        .central-node {
            position: absolute;
            top: 50%;
            left: 200px;
            transform: translateY(-50%);
            width: 180px;
            height: 80px;
            background: var(--primary);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(107, 70, 193, 0.4);
            z-index: 100;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .central-node:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 15px 40px rgba(107, 70, 193, 0.6);
        }

        .main-branch {
            position: absolute;
            top: 50%;
            left: 450px;
        }

        .node {
            position: absolute;
            background: var(--secondary);
            border-radius: 12px;
            padding: 15px 25px;
            color: white;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            min-width: 220px;
            text-align: left;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transform: translateY(-50%);
        }

        .sub-node {
            position: absolute;
            background: var(--accent);
            border-radius: 10px;
            padding: 12px 20px;
            color: white;
            font-weight: 500;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            min-width: 180px;
            text-align: left;
            user-select: none;
            opacity: 0;
            transform: translateY(-50%) scale(0);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .detail-node {
            position: absolute;
            background: var(--primary-200);
            border-radius: 8px;
            padding: 10px 15px;
            color: #2D165A;
            font-weight: 500;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            min-width: 160px;
            text-align: left;
            user-select: none;
            opacity: 0;
            transform: translateY(-50%) scale(0);
        }

        .expand-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-left: 10px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .expand-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }

        .expanded .expand-btn {
            transform: rotate(45deg);
        }

        .node:hover, .sub-node:hover, .detail-node:hover {
            transform: translateY(-50%) scale(1.03);
            box-shadow: var(--shadow-md);
        }

        .connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, rgba(107, 70, 193, 0.6), rgba(66, 153, 225, 0.6));
            z-index: 1;
            transform: translateY(-1px);
        }

        .sub-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, rgba(66, 153, 225, 0.6), rgba(72, 187, 120, 0.6));
            z-index: 1;
            transform: translateY(-1px);
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 200;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(0,0,0,.06);
            border-radius: 8px;
            padding: 12px 16px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            font-size: 12px;
            backdrop-filter: saturate(180%) blur(8px);
        }

        .control-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .breadcrumb {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 10px 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 200;
            font-size: 12px;
            color: var(--muted);
            border: 1px solid rgba(0,0,0,.06);
            backdrop-filter: saturate(180%) blur(8px);
        }
        .breadcrumb a { color: var(--primary); text-decoration: none; font-weight: 600; }
        .breadcrumb a:hover { text-decoration: underline; }

        .info-panel {
            position: fixed;
            top: 0;
            right: 0;
            height: 100vh;
            width: 360px;
            background: var(--surface);
            border-left: 1px solid rgba(0,0,0,.06);
            box-shadow: var(--shadow-md);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 200;
            padding: 24px 20px 28px;
            overflow-y: auto;
        }
        .info-panel.active { transform: translateX(0); }

        .info-panel h3 {
            color: #6b46c1;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .info-panel p {
            color: #666;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            pointer-events: none;
            z-index: 300;
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 200px;
        }

        .tooltip.show {
            opacity: 1;
        }

        .search-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 200;
        }

        .search-input {
            padding: 10px 15px;
            border: none;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            font-size: 14px;
            width: 300px;
        }

        .search-input:focus {
            outline: none;
            background: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .search-results {
          position: absolute;
          top: 42px;
          left: 0;
          width: 320px;
          max-height: 280px;
          overflow-y: auto;
          background: var(--surface);
          border-radius: 12px;
          box-shadow: var(--shadow-md);
          border: 1px solid rgba(0,0,0,.06);
          padding: 6px 6px;
        }
        .search-results li { list-style: none; padding: 10px 12px; border-radius: 8px; cursor: pointer; }
        .search-results li:hover { background: var(--secondary-100); }
        .search-results .match-path { display: block; font-size: 11px; color: var(--muted); margin-top: 4px; }

        /* Positionnement des branches principales verticalement */
        .branch-1 { top: calc(50% - 420px); }
        .branch-2 { top: calc(50% - 360px); }
        .branch-3 { top: calc(50% - 300px); }
        .branch-4 { top: calc(50% - 240px); }
        .branch-5 { top: calc(50% - 180px); }
        .branch-6 { top: calc(50% - 120px); }
        .branch-7 { top: calc(50% - 60px); }
        .branch-8 { top: calc(50% + 0px); }
        .branch-9 { top: calc(50% + 60px); }
        .branch-10 { top: calc(50% + 120px); }
        .branch-11 { top: calc(50% + 180px); }
        .branch-12 { top: calc(50% + 240px); }
        .branch-13 { top: calc(50% + 300px); }
        .branch-14 { top: calc(50% + 360px); }
        .branch-15 { top: calc(50% + 420px); }

        .fade-in {
            animation: fadeInScale 0.5s ease forwards;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: translateY(-50%) scale(0);
            }
            to {
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }
        }

        .highlight {
            box-shadow: 0 0 20px rgba(107, 70, 193, 0.8) !important;
            transform: translateY(-50%) scale(1.1) !important;
        }
    </style>
</head>
<body>
        <!-- Header -->
        <header class="sticky top-0 z-50 backdrop-blur-xl bg-white/80 border-b border-stroke/50">
            <div class="max-w-7xl mx-auto px-8">
                <div class="flex items-center justify-between h-20">
                    <!-- Logo -->
                    <div class="flex items-center gap-4">
                        <img src="src/assets/logo.png" alt="tarmaq" class="h-12 w-auto">
                    </div>
                    <!-- Desktop Navigation -->
                    <nav class="hidden lg:flex items-center gap-8">
                        <a href="index.html" class="font-semibold text-ink-2 hover:text-brand transition-colors">Accueil</a>
                        <a href="tarmaq-ad√©mie/index.html" class="font-semibold text-ink-2 hover:text-brand transition-colors">Cours Libre</a>
                        <a href="tarmaq_version_html_fondateur.html" class="font-semibold text-ink-2 hover:text-brand transition-colors">Projet</a>
                        <a href="Budget.html" class="font-semibold text-ink-2 hover:text-brand transition-colors">Budget</a>
                        <a href="tarmaq_interactive_mindmap.html" class="font-semibold text-ink-2 hover:text-brand transition-colors">Mindmap</a>
                    </nav>
                    <!-- CTA Buttons -->
                    <div class="hidden lg:flex items-center gap-4">
                        <button class="btn-secondary">Appel √† soutien</button>
                        <button class="btn-gradient">Faire un don</button>
                    </div>
                    <!-- View Switcher and Mobile Menu Button -->
                    <div class="flex items-center gap-2">
                        <!-- View Switcher Button -->
                        <button id="viewSwitcher" class="p-2 hover:bg-gray-100 rounded-lg transition-colors text-ink-2" title="Passer √† la vue mobile">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                        </button>
                        <!-- Mobile Menu Button -->
                        <button class="lg:hidden p-2" onclick="toggleMobileMenu()">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="lg:hidden hidden bg-white border-t border-stroke/50">
                <div class="px-8 py-4 space-y-4">
                    <a href="index.html" class="block font-semibold text-ink-2 hover:text-brand transition-colors">Accueil</a>
                    <a href="tarmaq-ad√©mie/index.html" class="block font-semibold text-ink-2 hover:text-brand transition-colors">Cours Libre</a>
                    <a href="tarmaq_version_html_fondateur.html" class="block font-semibold text-ink-2 hover:text-brand transition-colors">Projet</a>
                    <a href="Budget.html" class="block font-semibold text-ink-2 hover:text-brand transition-colors">Budget</a>
                    <a href="tarmaq_interactive_mindmap.html" class="block font-semibold text-ink-2 hover:text-brand transition-colors">Mindmap</a>
                    <div class="pt-4 space-y-2">
                        <button class="btn-secondary w-full">Appel √† soutien</button>
                        <button class="btn-gradient w-full">Faire un don</button>
                    </div>
                </div>
            </div>
        </header>

    <div class="mindmap-container" id="mindmapContainer">
        <div class="mindmap" id="mindmap">
            <svg id="wires" width="4000" height="3000" style="position:absolute; inset:0; pointer-events:none;"></svg>
            <!-- N≈ìud central -->
            <div class="central-node" id="centralNode">
                Projet Tarmaq
            </div>

            <!-- Connexion centrale -->
            <div class="connection" style="left: 380px; top: 50%; width: 70px;"></div>

            <!-- Branches principales -->
            <div class="main-branch branch-1">
                <div class="node" data-section="contexte" data-level="1">
                    <span>Contexte & Probl√©matique</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-2">
                <div class="node" data-section="demande" data-level="1">
                    <span>Demande de Soutien</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-3">
                <div class="node" data-section="vision" data-level="1">
                    <span>Vision & Valeur Ajout√©e</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-4">
                <div class="node" data-section="objectifs" data-level="1">
                    <span>Objectifs du Projet</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-5">
                <div class="node" data-section="activites" data-level="1">
                    <span>Activit√©s Pr√©vues</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-6">
                <div class="node" data-section="publics" data-level="1">
                    <span>Publics Cibles</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-7">
                <div class="node" data-section="retombees" data-level="1">
                    <span>Retomb√©es Attendues</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-8">
                <div class="node" data-section="economique" data-level="1">
                    <span>Mod√®le √âconomique</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-9">
                <div class="node" data-section="budget" data-level="1">
                    <span>Budgets Pr√©visionnels (3 ans)</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-10">
                <div class="node" data-section="calendrier" data-level="1">
                    <span>Calendrier Pr√©visionnel (2025-2026)</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-11">
                <div class="node" data-section="indicateurs" data-level="1">
                    <span>Indicateurs & √âvaluation d'Impact</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-12">
                <div class="node" data-section="risques" data-level="1">
                    <span>Risques & Mesures</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-13">
                <div class="node" data-section="gouvernance" data-level="1">
                    <span>Gouvernance & Conformit√©</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-14">
                <div class="node" data-section="communication" data-level="1">
                    <span>Plan de Communication</span>
                    <button class="expand-btn">></button>
                </div>
            </div>

            <div class="main-branch branch-15">
                <div class="node" data-section="expansion" data-level="1">
                    <span>Feuille de Route d'Expansion (2025-2030)</span>
                    <button class="expand-btn">></button>
                </div>
            </div>
        </div>
    </div>

    <div class="search-container">
        <input type="text" class="search-input" placeholder="üîç Rechercher dans le projet..." id="searchInput">
        <ul id="searchResults" class="search-results hidden"></ul>
    </div>

    <div class="breadcrumb" id="breadcrumb">
        Projet Tarmaq
    </div>

    <div class="controls">
        <button class="control-btn" onclick="resetView()">üè† Centre</button>
        <button class="control-btn" onclick="zoomIn()">üîç Zoom +</button>
        <button class="control-btn" onclick="zoomOut()">üîç Zoom -</button>
        <button class="control-btn" onclick="collapseAll()">üìÅ Tout Fermer</button>
        <button class="control-btn" onclick="expandAll()">üìÇ Tout Ouvrir</button>
        <button class="control-btn" onclick="toggleInfo()">‚ÑπÔ∏è Info</button>
        <button class="control-btn" onclick="closeInfo()">‚ùå Fermer Info</button>
    </div>

    <div class="info-panel" id="infoPanel">
        <h3>Informations</h3>
        <p id="infoPanelContent">Cliquez sur un √©l√©ment pour voir les d√©tails</p>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Configuration des donn√©es avec structure hi√©rarchique
        const projectData = {
            contexte: {
                title: "Contexte & Probl√©matique",
                info: "Analyse du contexte march√© et identification des d√©fis majeurs de l'innovation collaborative",
                children: {
                    defis: {
                        title: "D√©fis Contemporains",
                        info: "Les 3 d√©fis majeurs que Tarmaq r√©sout",
                        children: [
                            { title: "R√©sistance Technologique", info: "70% organisations r√©sistent aux nouvelles technologies" },
                            { title: "Fragmentation G√©ographique", info: "73% des collaborations limit√©es par les fronti√®res" },
                            { title: "Silos de Connaissances", info: "67% des innovations restent confidentielles" }
                        ]
                    },
                    conviction: {
                        title: "Notre Conviction",
                        info: "Les 3 piliers de notre vision d'avenir",
                        children: [
                            { title: "Tech-Forward", info: "Embrasser la technologie plut√¥t que la subir" },
                            { title: "Global-Minded", info: "Penser global plut√¥t que local" },
                            { title: "Knowledge-Sharing", info: "Partager pour mieux recevoir" }
                        ]
                    }
                }
            },
            vision: {
                title: "Vision & Valeur Ajout√©e",
                info: "Notre vision strat√©gique et proposition de valeur unique pour l'√©cosyst√®me d'innovation",
                children: {
                    ecosysteme: {
                        title: "√âcosyst√®me Physique et Digital",
                        info: "Plateforme hybride alliant espaces physiques et outils num√©riques",
                        children: [
                            { title: "Innovation Labs", info: "Espaces de co-cr√©ation √©quip√©s" },
                            { title: "Plateforme Collaborative", info: "Outils digitaux avanc√©s" },
                            { title: "R√©alit√© Mixte", info: "VR/AR pour collaboration immersive" }
                        ]
                    },
                    apprentissage: {
                        title: "Apprendre en Faisant",
                        info: "P√©dagogie active bas√©e sur l'exp√©rimentation et la pratique",
                        children: [
                            { title: "Learning by Doing", info: "Projets concrets et applicables" },
                            { title: "Peer Learning", info: "Apprentissage collaboratif" },
                            { title: "Mentorship", info: "Accompagnement expert" }
                        ]
                    },
                    ia: {
                        title: "IA Responsable √† Port√©e de Main",
                        info: "Intelligence artificielle √©thique et accessible √† tous",
                        children: [
                            { title: "AI Ethics", info: "D√©veloppement responsable" },
                            { title: "D√©mocratisation", info: "Acc√®s facilit√© aux outils IA" },
                            { title: "Formation", info: "√âducation aux enjeux IA" }
                        ]
                    },
                    ouverture: {
                        title: "Ouverture & Mobilit√©",
                        info: "Connexion globale et mobilit√© internationale des talents",
                        children: [
                            { title: "R√©seau Global", info: "50K+ experts dans 100+ pays" },
                            { title: "Mobilit√© Talent", info: "Programmes d'√©change internationaux" },
                            { title: "Cultural Bridge", info: "Pont entre √©cosyst√®mes" }
                        ]
                    },
                    intergenerationnel: {
                        title: "Lien Interg√©n√©rationnel",
                        info: "Connexion entre g√©n√©rations pour transfert de savoirs",
                        children: [
                            { title: "Mentorship Senior", info: "Experts exp√©riment√©s" },
                            { title: "Reverse Mentoring", info: "Jeunes talents tech" },
                            { title: "Knowledge Transfer", info: "Transmission optimis√©e" }
                        ]
                    },
                    ancrage: {
                        title: "Ancrage Local",
                        info: "D√©veloppement territorial et √©cosyst√®me local",
                        children: [
                            { title: "√âcosyst√®me R√©gional", info: "Partenaires locaux" },
                            { title: "Impact Territorial", info: "Cr√©ation d'emplois locaux" },
                            { title: "Innovation Locale", info: "Valorisation savoir-faire" }
                        ]
                    },
                    catalyseur: {
                        title: "Catalyseur d'Opportunit√©s",
                        info: "G√©n√©rateur de synergies et d'opportunit√©s business",
                        children: [
                            { title: "Business Matching", info: "Connexions strat√©giques" },
                            { title: "Innovation Pipeline", info: "Flux continu d'opportunit√©s" },
                            { title: "Value Creation", info: "G√©n√©ration de valeur partag√©e" }
                        ]
                    }
                }
            },
            objectifs: {
                title: "Objectifs Strat√©giques",
                info: "Roadmap d√©taill√©e et objectifs mesurables sur 4 ans",
                children: {
                    year1: {
                        title: "2025 - Foundation",
                        info: "Construction des bases et validation concept",
                        children: [
                            { title: "MVP Plateforme", info: "1000 utilisateurs beta, 5 technos core" },
                            { title: "√âquipe Core", info: "25 personnes, expertises cl√©s" },
                            { title: "Premiers Revenus", info: "500K‚Ç¨ ARR" }
                        ]
                    },
                    year2: {
                        title: "2026 - Acc√©l√©ration",
                        info: "Croissance rapide et expansion g√©ographique",
                        children: [
                            { title: "10K Utilisateurs", info: "Croissance utilisateurs actifs" },
                            { title: "Expansion International", info: "15 pays, localisation" },
                            { title: "2,2M‚Ç¨ Revenus", info: "Croissance exponentielle" }
                        ]
                    },
                    year3: {
                        title: "2027 - Leadership",
                        info: "Position de leader et profitabilit√©",
                        children: [
                            { title: "50K Utilisateurs", info: "30 pays, adoption massive" },
                            { title: "100+ Partenaires", info: "√âcosyst√®me riche" },
                            { title: "5,8M‚Ç¨ Revenus", info: "Rentabilit√© op√©rationnelle" }
                        ]
                    }
                }
            },
            economique: {
                title: "Mod√®le √âconomique",
                info: "Architecture des revenus diversifi√©e et durable",
                children: {
                    subscriptions: {
                        title: "Subscriptions SaaS (60%)",
                        info: "Revenus r√©currents de la plateforme",
                        children: [
                            { title: "Professional 99‚Ç¨/mois", info: "PME et consultants" },
                            { title: "Enterprise 299‚Ç¨/mois", info: "Grandes entreprises" },
                            { title: "Global 1000‚Ç¨+/mois", info: "Multinationales" }
                        ]
                    },
                    services: {
                        title: "Services & Consulting (25%)",
                        info: "Services d'accompagnement et expertise",
                        children: [
                            { title: "Tech Audit", info: "√âvaluation technologique" },
                            { title: "Innovation Roadmap", info: "Strat√©gie personnalis√©e" },
                            { title: "Implementation Support", info: "Accompagnement d√©ploiement" }
                        ]
                    },
                    education: {
                        title: "Education & Training (10%)",
                        info: "Formations et certifications",
                        children: [
                            { title: "Certifications Tech", info: "IA, Blockchain, VR/AR" },
                            { title: "Corporate Training", info: "Formation entreprise" },
                            { title: "Online Learning", info: "Modules e-learning" }
                        ]
                    },
                    ventures: {
                        title: "Ventures & Equity (5%)",
                        info: "Investissement et co-cr√©ation",
                        children: [
                            { title: "Equity Participation", info: "5-20% dans startups" },
                            { title: "Success Fees", info: "Technology transfer" },
                            { title: "Revenue Sharing", info: "Innovations commercialis√©es" }
                        ]
                    }
                }
            },
            expansion: {
                title: "Feuille de Route d'Expansion",
                info: "Strat√©gie d'expansion internationale 2025-2030",
                children: {
                    phase1: {
                        title: "Phase 1 - Europe (2025)",
                        info: "Consolidation du march√© europ√©en",
                        children: [
                            { title: "France (Base)", info: "March√© domestique, 300K‚Ç¨ ARR" },
                            { title: "DACH", info: "Allemagne, Autriche, Suisse" },
                            { title: "UK & Nordics", info: "Pr√©paration 2026" }
                        ]
                    },
                    phase2: {
                        title: "Phase 2 - Americas (2026)",
                        info: "Conqu√™te du march√© nord-am√©ricain",
                        children: [
                            { title: "United States", info: "Silicon Valley + Boston" },
                            { title: "Canada", info: "Toronto + Vancouver" },
                            { title: "800K$ ARR Target", info: "Premi√®re ann√©e Americas" }
                        ]
                    },
                    phase3: {
                        title: "Phase 3 - APAC (2027-2028)",
                        info: "Expansion Asie-Pacifique",
                        children: [
                            { title: "Singapore Hub", info: "QG r√©gional" },
                            { title: "Australia & NZ", info: "March√©s anglophones" },
                            { title: "Japan Entry", info: "March√© strat√©gique 2028" }
                        ]
                    }
                }
            }
        };

        // Auto-register missing sections from DOM nodes
        function bootstrapMissingSections() {
          document.querySelectorAll('[data-section][data-level="1"]').forEach(n => {
            const k = n.getAttribute('data-section');
            const titleText = n.querySelector('span')?.textContent?.trim() || k;
            if (!projectData[k]) {
              projectData[k] = { title: titleText, info: "Section √† compl√©ter", children: {} };
            }
          });
        }

        // Variables globales
        let scale = 1;
        let isDragging = false;
        let startX, startY;
        let currentX = 0, currentY = 0;
        let expandedNodes = new Set();

        const mindmap = document.getElementById('mindmap');
        const container = document.getElementById('mindmapContainer');
        const tooltip = document.getElementById('tooltip');
        const breadcrumb = document.getElementById('breadcrumb');
        const infoPanel = document.getElementById('infoPanel');
        const infoPanelContent = document.getElementById('infoPanelContent');
        const wires = document.getElementById('wires');
        const searchResultsEl = document.getElementById('searchResults');

        function cubicPath(x1, y1, x2, y2) {
          const dx = Math.max(60, (x2 - x1) * 0.4);
          return `M ${x1} ${y1} C ${x1 + dx} ${y1}, ${x2 - dx} ${y2}, ${x2} ${y2}`;
        }

        function drawWireAbs(x1, y1, x2, y2) {
          const p = document.createElementNS('http://www.w3.org/2000/svg','path');
          p.setAttribute('d', cubicPath(x1, y1, x2, y2));
          p.setAttribute('fill', 'none');
          p.setAttribute('stroke', 'url(#wireGradient)');
          p.setAttribute('stroke-width', '2');
          p.setAttribute('opacity', '0.8');
          wires.appendChild(p);
          return p;
        }

        // Define gradient once
        const gradDef = document.createElementNS('http://www.w3.org/2000/svg','defs');
        const lg = document.createElementNS('http://www.w3.org/2000/svg','linearGradient');
        lg.setAttribute('id','wireGradient'); lg.setAttribute('x1','0%'); lg.setAttribute('x2','100%'); lg.setAttribute('y1','0%'); lg.setAttribute('y2','0%');
        const s1 = document.createElementNS('http://www.w3.org/2000/svg','stop'); s1.setAttribute('offset','0%'); s1.setAttribute('stop-color', '#a78bfa');
        const s2 = document.createElementNS('http://www.w3.org/2000/svg','stop'); s2.setAttribute('offset','100%'); s2.setAttribute('stop-color', '#60a5fa');
        lg.appendChild(s1); lg.appendChild(s2); gradDef.appendChild(lg); wires.appendChild(gradDef);

        function centerOnElement(el, padding = 80) {
          const cRect = container.getBoundingClientRect();
          const eRect = el.getBoundingClientRect();
          const targetX = (cRect.width / 2) - (eRect.left + eRect.width / 2) + currentX;
          const targetY = (cRect.height / 2) - (eRect.top + eRect.height / 2) + currentY;
          currentX = targetX; currentY = targetY; updateTransform();
        }

        function updateBreadcrumb(path) {
          if (!Array.isArray(path) || !path.length) { breadcrumb.textContent = 'Projet Tarmaq'; return; }
          breadcrumb.innerHTML = ['<a href="#" data-bc-index="-1">Projet Tarmaq</a>']
            .concat(path.map((p, i) => ` &gt; <a href="#" data-bc-index="${i}">${p}</a>`)).join('');
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', initializeMap);

        function initializeMap() {
            bootstrapMissingSections();
            setupEventListeners();
            createMainConnections();
        }

        function createMainConnections() {
            // Clear previous wires
            while (wires.firstChild && wires.firstChild.nodeName !== 'defs') wires.removeChild(wires.firstChild);

            const branches = document.querySelectorAll('.main-branch > .node');
            branches.forEach((nodeEl) => {
              const nRect = nodeEl.getBoundingClientRect();
              const mRect = mindmap.getBoundingClientRect();
              // Central node right edge
              const centerEl = document.getElementById('centralNode');
              const cRect = centerEl.getBoundingClientRect();
              const x1 = (cRect.right - mRect.left);
              const y1 = (cRect.top + cRect.height / 2 - mRect.top);
              const x2 = (nRect.left - mRect.left);
              const y2 = (nRect.top + nRect.height / 2 - mRect.top);
              drawWireAbs(x1, y1, x2, y2);
            });
        }

        function setupEventListeners() {
            // Navigation
            container.addEventListener('mousedown', startDrag);
            container.addEventListener('mousemove', drag);
            container.addEventListener('mouseup', stopDrag);
            container.addEventListener('mouseleave', stopDrag);
            container.addEventListener('wheel', handleWheel);

            // Expansion des n≈ìuds
            document.querySelectorAll('.expand-btn').forEach(btn => {
                btn.addEventListener('click', handleExpand);
            });

            // Tooltips et info
            document.querySelectorAll('[data-section]').forEach(element => {
                element.addEventListener('mouseenter', showTooltip);
                element.addEventListener('mouseleave', hideTooltip);
                element.addEventListener('mousemove', moveTooltip);
                element.addEventListener('click', showNodeInfo);
            });

            // Recherche
            document.getElementById('searchInput').addEventListener('input', handleSearch);

            // Keyboard shortcuts
            window.addEventListener('keydown', (e) => {
              if (e.key === '+') { zoomIn(); }
              else if (e.key === '-') { zoomOut(); }
              else if (e.key === '0') { resetView(); }
              else if (e.key === 'Escape') { collapseAll(); closeInfo(); }
            });

            // Breadcrumb clicks
            breadcrumb.addEventListener('click', (e) => {
              const a = e.target.closest('a[data-bc-index]');
              if (!a) return;
              e.preventDefault();
              const idx = parseInt(a.getAttribute('data-bc-index'), 10);
              if (idx === -1) { closeInfo(); resetView(); return; }
            });
        }

        function handleExpand(e) {
            e.stopPropagation();
            const node = e.target.closest('[data-section]');
            const section = node.getAttribute('data-section');
            const level = parseInt(node.getAttribute('data-level'));
            
            if (expandedNodes.has(section)) {
                collapseNode(section, node);
            } else {
                expandNode(section, node, level);
            }
        }

        function expandNode(section, parentNode, level) {
            expandedNodes.add(section);
            parentNode.classList.add('expanded');
            
            const data = projectData[section];
            if (!data || !data.children) return;

            const parentRect = parentNode.getBoundingClientRect();
            const mindmapRect = mindmap.getBoundingClientRect();
            
            let yOffset = -((Object.keys(data.children).length - 1) * 30);
            
            Object.entries(data.children).forEach(([key, childData], index) => {
                createSubNode(key, childData, parentNode, index, level + 1, section, yOffset + (index * 60));
            });
        }

        function createSubNode(key, data, parentNode, index, level, parentSection, yOffset) {
            const subNode = document.createElement('div');
            subNode.className = level === 2 ? 'sub-node' : 'detail-node';
            subNode.setAttribute('data-section', key);
            subNode.setAttribute('data-level', level);
            subNode.setAttribute('data-parent', parentSection);
            
            const xDistance = level === 2 ? 300 : 250;
            
            subNode.style.left = xDistance + 'px';
            subNode.style.top = yOffset + 'px';
            
            subNode.innerHTML = `
                <span>${data.title}</span>
                ${data.children ? '<button class="expand-btn">></button>' : ''}
            `;
            
            parentNode.appendChild(subNode);

            // Draw SVG wire parent -> this subNode
            requestAnimationFrame(() => {
              const mRect = mindmap.getBoundingClientRect();
              const pRect = parentNode.getBoundingClientRect();
              const sRect = subNode.getBoundingClientRect();
              const x1 = (pRect.right - mRect.left);
              const y1 = (pRect.top + pRect.height/2 - mRect.top);
              const x2 = (sRect.left - mRect.left);
              const y2 = (sRect.top + sRect.height/2 - mRect.top);
              drawWireAbs(x1, y1, x2, y2);
            });

            // Animation d'apparition
            setTimeout(() => {
                subNode.classList.add('fade-in');
            }, index * 100);
            
            // Event listeners
            subNode.addEventListener('click', showNodeInfo);
            subNode.addEventListener('mouseenter', showTooltip);
            subNode.addEventListener('mouseleave', hideTooltip);
            subNode.addEventListener('mousemove', moveTooltip);
            
            if (data.children) {
                const expandBtn = subNode.querySelector('.expand-btn');
                expandBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    expandSubNode(key, data, subNode, level + 1);
                });
            }
        }

        function expandSubNode(key, data, parentNode, level) {
            if (!data.children || !Array.isArray(data.children)) return;
            
            const xDistance = 250;
            let yOffset = -((data.children.length - 1) * 20);
            
            data.children.forEach((item, index) => {
                const detailNode = document.createElement('div');
                detailNode.className = 'detail-node';
                detailNode.style.left = xDistance + 'px';
                detailNode.style.top = (yOffset + (index * 40)) + 'px';
                detailNode.innerHTML = `<span>${item.title}</span>`;
                
                // Event listeners pour les n≈ìuds de d√©tail
                detailNode.addEventListener('click', () => {
                    infoPanelContent.innerHTML = `
                        <h3>${item.title}</h3>
                        <p>${item.info}</p>
                    `;
                    infoPanel.classList.add('active');
                });
                
                detailNode.addEventListener('mouseenter', (e) => {
                    tooltip.textContent = item.info;
                    tooltip.classList.add('show');
                    moveTooltip(e);
                });
                
                detailNode.addEventListener('mouseleave', hideTooltip);
                detailNode.addEventListener('mousemove', moveTooltip);
                
                parentNode.appendChild(detailNode);
                
                // Animation
                setTimeout(() => {
                    detailNode.classList.add('fade-in');
                }, index * 50);

                // Draw SVG wire for detail node
                requestAnimationFrame(() => {
                  const mRect = mindmap.getBoundingClientRect();
                  const pRect = parentNode.getBoundingClientRect();
                  const sRect = detailNode.getBoundingClientRect();
                  const x1 = (pRect.right - mRect.left);
                  const y1 = (pRect.top + pRect.height/2 - mRect.top);
                  const x2 = (sRect.left - mRect.left);
                  const y2 = (sRect.top + sRect.height/2 - mRect.top);
                  drawWireAbs(x1, y1, x2, y2);
                });
            });
        }

        function collapseNode(section, node) {
            expandedNodes.delete(section);
            node.classList.remove('expanded');
            
            // Supprimer tous les sous-n≈ìuds et connexions
            const subElements = node.querySelectorAll('.sub-node, .detail-node, .sub-connection');
            subElements.forEach(element => {
                element.style.opacity = '0';
                element.style.transform += ' scale(0)';
                setTimeout(() => element.remove(), 300);
            });
            // Clear wires (except defs)
            while (wires.firstChild && wires.firstChild.nodeName !== 'defs') wires.removeChild(wires.firstChild);
            createMainConnections();
        }

        function showNodeInfo(e) {
            e.stopPropagation();
            const section = e.currentTarget.getAttribute('data-section');
            const titleText = e.currentTarget.querySelector('span')?.textContent?.trim();
            const data = projectData[section] || { title: titleText || section, info: '' };
            infoPanelContent.innerHTML = `
              <h3>${data.title}</h3>
              <p>${data.info || ''}</p>
              ${data.children ? `<p><strong>Sous-sections:</strong> ${Array.isArray(data.children) ? data.children.length : Object.keys(data.children).length}</p>` : ''}
            `;
            infoPanel.classList.add('active');
            // Update breadcrumb
            updateBreadcrumb([data.title]);
            // Visual selection
            document.querySelectorAll('.selected').forEach(n => n.classList.remove('selected'));
            e.currentTarget.classList.add('selected');
            // Center view on node
            centerOnElement(e.currentTarget);
        }

        function handleSearch(e) {
          const query = e.target.value.trim().toLowerCase();
          const allNodes = Array.from(document.querySelectorAll('.node, .sub-node, .detail-node'));
          // Reset visuals
          allNodes.forEach(n => { n.style.opacity = '1'; n.classList.remove('highlight'); });
          searchResultsEl.innerHTML = '';
          if (!query) { searchResultsEl.classList.add('hidden'); return; }

          const results = [];
          allNodes.forEach(n => {
            const text = n.textContent.toLowerCase();
            if (text.includes(query)) {
              results.push(n);
              n.classList.add('highlight');
            }
          });

          // Populate dropdown (max 8)
          results.slice(0,8).forEach(n => {
            const li = document.createElement('li');
            const label = n.textContent.trim();
            li.innerHTML = `<div>${label}</div><span class="match-path">Aller √† cet √©l√©ment</span>`;
            li.addEventListener('click', () => {
              searchResultsEl.classList.add('hidden');
              centerOnElement(n);
              n.classList.add('selected');
              n.classList.add('highlight');
              n.scrollIntoView?.({ block: 'center', inline: 'center' });
            });
            searchResultsEl.appendChild(li);
          });
          searchResultsEl.classList.toggle('hidden', results.length === 0);
        }

        // Fonctions de contr√¥le
        function resetView() {
            scale = 1;
            currentX = 0;
            currentY = 0;
            updateTransform();
        }

        function zoomIn() {
            scale *= 1.2;
            scale = Math.min(3, scale);
            updateTransform();
        }

        function zoomOut() {
            scale *= 0.8;
            scale = Math.max(0.3, scale);
            updateTransform();
        }

        function collapseAll() {
            expandedNodes.clear();
            document.querySelectorAll('.expanded').forEach(node => {
                node.classList.remove('expanded');
            });
            document.querySelectorAll('.sub-node, .detail-node, .sub-connection').forEach(node => {
                node.style.opacity = '0';
                node.style.transform += ' scale(0)';
                setTimeout(() => node.remove(), 300);
            });
            // Clear wires (except defs)
            while (wires.firstChild && wires.firstChild.nodeName !== 'defs') wires.removeChild(wires.firstChild);
            createMainConnections();
        }

        function expandAll() {
            document.querySelectorAll('[data-section][data-level="1"]').forEach(node => {
                const section = node.getAttribute('data-section');
                if (!expandedNodes.has(section)) {
                    expandNode(section, node, 1);
                }
            });
        }

        function toggleInfo() {
            infoPanel.classList.toggle('active');
        }

        // Fonctions de navigation
        function startDrag(e) {
            if (e.target.closest('.node, .sub-node, .detail-node, .expand-btn')) return;
            isDragging = true;
            startX = e.clientX - currentX;
            startY = e.clientY - currentY;
            container.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            currentX = e.clientX - startX;
            currentY = e.clientY - startY;
            updateTransform();
        }

        function stopDrag() {
            isDragging = false;
            container.style.cursor = 'grab';
        }

        function handleWheel(e) {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            scale *= delta;
            scale = Math.max(0.3, Math.min(3, scale));
            updateTransform();
        }

        function updateTransform() {
            mindmap.style.transform = `translate(calc(-25% + ${currentX}px), calc(-50% + ${currentY}px)) scale(${scale})`;
            // Recompute wires after layout change
            createMainConnections();
        }
        function closeInfo() { infoPanel.classList.remove('active'); }

        // Fonctions tooltip
        function showTooltip(e) {
            const section = e.currentTarget.getAttribute('data-section');
            const data = projectData[section];
            if (data && data.info) {
                tooltip.textContent = data.info;
                tooltip.classList.add('show');
                moveTooltip(e);
            }
        }

        function hideTooltip() {
            tooltip.classList.remove('show');
        }

        function moveTooltip(e) {
            const rect = container.getBoundingClientRect();
            tooltip.style.left = (e.clientX - rect.left + 10) + 'px';
            tooltip.style.top = (e.clientY - rect.top - 10) + 'px';
        }

        // Mobile menu toggle function
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
        document.getElementById('centralNode').addEventListener('click', (e) => {
          centerOnElement(e.currentTarget);
          infoPanelContent.innerHTML = `<h3>Projet Tarmaq</h3><p>Carte interactive du projet. Utilisez la recherche (‚åò/Ctrl+F nativement ou le champ en haut) et les boutons pour naviguer.</p>`;
          infoPanel.classList.add('active');
          updateBreadcrumb(['Projet Tarmaq']);
        });